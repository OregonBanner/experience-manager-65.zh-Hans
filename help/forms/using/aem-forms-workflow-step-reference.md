---
title: OSGi上以Forms為中心的工作流程 — 步驟參考
seo-title: Forms-centric workflow on OSGi - Step Reference
description: 以OSGi步驟為中心的Forms工作流程，可讓您快速建立最適化表單式工作流程。
seo-description: Forms-centric workflow on OSGi steps allow you rapidly build adaptive forms based workflows.
uuid: 6f791c45-0e35-4c55-9106-5340caab94b7
products: SG_EXPERIENCEMANAGER/6.5/FORMS
topic-tags: publish
discoiquuid: f0a5588d-f210-4f04-bc35-b62834f90ab1
docset: aem65
exl-id: 470fcfda-dfde-437c-b539-d5af1e13a7d6
source-git-commit: 37d2c70bff770d13b8094c5959e488f5531aef55
workflow-type: tm+mt
source-wordcount: '7575'
ht-degree: 0%

---

# OSGi上以Forms為中心的工作流程 — 步驟參考 {#forms-centric-workflow-on-osgi-step-reference}

您可以使用工作流程模型將商業邏輯轉換為自動化重複式處理。 模型可協助您定義並執行一系列步驟。 您也可以定義模型屬性，例如工作流程是暫時的或使用多個資源。 您可以 [在模型中加入各種AEM Workflow步驟以實現商業邏輯](/help/sites-developing/workflows-models.md#extending-aem).

## Forms Workflow步驟 {#forms-workflow-steps}

Forms工作流程步驟會在AEM工作流程中執行AEM Forms特定的操作。 這些步驟可讓您在OSGi上快速建立以Forms為中心的最適化表單工作流程。 這些工作流程可用於開發基本的稽核和核准工作流程、內部和跨防火牆業務流程。 您也可以使用Forms Workflow步驟來啟動檔案服務、與Adobe Sign簽名工作流程整合，以及執行其他AEM Forms操作。 您需要 [AEM Forms附加元件](https://www.adobe.com/go/learn_aemforms_documentation_63) 在工作流程中使用這些步驟。

以Forms為中心的工作流程步驟會在AEM Workflow中執行AEM Forms特定的操作。 這些步驟可讓您在OSGi上快速建立以Adaptive Forms為基礎的Forms工作流程。 這些工作流程可用於開發基本的稽核和核准工作流程、內部和跨防火牆業務流程。

>[!NOTE]
>
>如果將工作流程模型標示為外部儲存，則對於所有Forms工作流程步驟，您只能選取變數選項來儲存或擷取資料檔案和附件。

## 指派任務步驟 {#assign-task-step}

指派任務步驟會建立任務並將其指派給使用者或群組。 除了指派任務外，元件也會指定任務的最適化表單或非互動式PDF。 最適化表單必須接受使用者的輸入，非互動式PDF或使用唯讀最適化表單進行僅稽核工作流程。

您也可以使用元件來控制工作的行為。 例如，建立自動記錄檔案、將任務指派給特定使用者或群組、指定提交資料的路徑、指定要預先填入的資料路徑，以及指定預設動作。 「指派工作」步驟具有以下屬性：

* **標題：** 工作的標題。 標題會顯示在AEM收件匣中。
* **說明：** 說明在任務中執行的作業。 當您在共用開發環境中工作時，此資訊對於其他程式開發人員很有用。

* **縮圖路徑：** 任務縮圖的路徑。 若未指定路徑，則會針對最適化表單顯示預設縮圖，而針對記錄檔案，則會顯示預設圖示。
* **工作流程階段：** 一個工作流程可以有多個階段。 這些階段會顯示在AEM收件匣中。 您可以在模型屬性中定義這些階段（Sidekick >頁面>頁面屬性>階段）。
* **優先順序：** 選取的優先順序會顯示在AEM收件匣中。 可用的選項包括「高」、「中」和「低」。 預設值為Medium。
* **到期日：** 指定在幾天或幾小時後任務會標籤為過期。 如果您選取 **關閉**，則不會將任務標示為過期。 您也可以指定逾時處理常式，以便在任務逾期後執行特定任務。

* **天數：** 工作要完成之前的天數。 將任務指派給使用者後會計入天數。 如果任務未完成並超過「天數」欄位中指定的天數，則如果選取，逾時處理常式會在到期日後觸發。
* **小時：** 工作要完成之前的小時數。 將任務指派給使用者後會計入小時數。 如果任務未完成並超過「時數」欄位中指定的時數，則如果選取，逾時處理常式會在到期時數之後觸發。
* **到期日後逾時：** 選取此選項可啟用「逾時處理常式」選取欄位。
* **逾時處理常式：** 選取指派工作步驟超過到期日時要執行的指令碼。 放置在CRX存放庫中的指令碼： [應用程式]/fd/dashboard/scripts/timeoutHandler可供選取。 crx-repository中不存在指定的路徑。 管理員會在使用之前建立路徑。
* **在任務詳細資訊中反白上一個任務的動作和註解：** 選取此選項可顯示上次在任務的任務詳細資訊區段上採取的動作和收到的註解。
* **型別：** 選擇工作流程啟動時要填寫的檔案型別。 您可以選擇最適化表單、唯讀最適化表單、非互動式PDF檔案、互動式通訊代理程式UI或互動式通訊Web Channel檔案。
* **使用最適化表單：** 指定尋找輸入的最適化表單的方法。 如果您從「型別」下拉式清單中選取「最適化表單」或「唯讀最適化表單」，即可使用此選項。 您可以使用提交至工作流程的最適化表單、在絕對路徑提供的表單，或在變數中的路徑提供的表單。 您可以使用字串型別的變數來指定路徑。\
   您可以將多個最適化表單與工作流程建立關聯。 因此，您可以使用可用的輸入方法，在執行階段指定最適化表單。

* **使用互動式通訊：** 指定尋找輸入互動式通訊的方法。 您可以使用提交至工作流程的互動式通訊、在絕對路徑上提供的通訊，或在變數中的路徑上提供的通訊。 您可以使用字串型別的變數來指定路徑。 如果您從「型別」下拉式清單中選取「互動式通訊代理程式UI」或「互動式通訊Web Channel檔案」，即可使用此選項。

>[!NOTE]
>
>您必須擁有cm-agent-users和workflow-users群組指派，才能存取AEM收件匣中的互動式通訊代理程式UI。

* **最適化表單或互動式通訊路徑**：指定最適化表單或互動式通訊的路徑。 您可以使用提交至工作流程的最適化表單或互動式通訊（以絕對路徑提供），或從儲存在字串資料型別變數中的路徑擷取最適化表單。
* **選擇輸入PDF，使用：** 指定非互動式PDF檔案的路徑。 當您在「型別」欄位中選擇非互動式PDF檔案時，該欄位可用。 您可以使用相對於承載的路徑、以絕對路徑儲存的路徑，或使用Document資料型別的變數來選取輸入PDF。 例如， [Payload_Directory]/Workflow/PDF/credit-card.pdf. crx-repository中不存在該路徑。 管理員會在使用之前建立路徑。 您需要啟用「記錄檔案」選項或表單範本式調適型表單，才能使用「PDF路徑」選項。
* **對於已完成的工作，將最適化表單轉譯為**：當任務標示為完成時，您可以將最適化表單轉譯為唯讀最適化表單或PDF檔案。 您需要啟用記錄檔案選項或表單範本式的最適化表單，才能將最適化表單呈現為記錄檔案。
* **預先填入：** 下列欄位會作為任務的輸入專案：

   * **[!UICONTROL 選擇輸入資料檔案，使用]**：輸入資料檔案的路徑（.json、.xml、.doc或表單資料模型）。 您可以使用相對於承載的路徑來擷取輸入資料檔案，或擷取儲存在Document、XML或JSON資料型別變數中的檔案。 例如，檔案包含透過AEM收件匣應用程式為表單提交的資料。 範例路徑為 [Payload_Directory]/workflow/data.

   * **選擇輸入附件，使用：** 該位置可用的附件會附加至與任務相關聯的表單。 路徑可以是相對於承載或擷取儲存在ArrayList of Document型別的變數中的附件。 範例路徑為 [Payload_Directory]/attachments/. 您可以指定相對於承載放置的附件，或使用檔案型別（「陣列清單」>「檔案」）變數來指定最適化表單的輸入附件。

      * **選擇輸入JSON：** 使用相對於承載或儲存在Document、JSON或表單資料模型資料型別變數中的路徑來選取輸入JSON檔案。 如果您從「型別」下拉式清單中選取「互動式通訊代理程式UI」或「互動式通訊Web Channel檔案」，即可使用此選項。
      * **選擇自訂預填服務：** 選取預填服務以擷取資料並預填互動式通訊Web Channel檔案或代理程式UI。
      * **使用以上所選互動式通訊的預填服務：** 使用此選項可使用使用互動式通訊下拉式清單中定義的互動式通訊預填服務。
      * **要求屬性對應：** 使用「請求屬性對應」段落定義 [要求屬性的名稱和值](../../forms/using/work-with-form-data-model.md#bindargument). 根據請求中指定的屬性名稱和值，從資料來源擷取詳細資訊。 您可以使用常值或String資料型別的變數來定義請求屬性值。\
         您必須從「型別」下拉式清單中選取「互動式通訊代理程式UI」或「互動式通訊Web Channel檔案」，才能使用預填服務和要求屬性對應選項。

* **提交的資訊：** 下列欄位會作為工作的輸出位置：

   * **使用以下專案儲存輸出資料檔案：** 儲存資料檔案(.json，. xml、.doc或表單資料模型)。 資料檔案包含透過相關表單提交的資訊。 您可以使用相對於承載的路徑來儲存輸出資料檔案，或將其儲存在Document、XML或JSON資料型別的變數中。 例如， [Payload_Directory]/Workflow/data，其中資料是檔案。
   * **儲存附件，使用：** 儲存任務中提供的表單附件。 您可以使用相對於承載的路徑來儲存附件，或將其儲存在Document資料型別陣列的變數中。
   * **儲存記錄檔案，使用：** 儲存記錄檔案檔案的路徑。 例如， [Payload_Directory]/DocumentofRecord/credit-card.pdf. 您可以使用相對於承載的路徑來儲存記錄檔案，或將其儲存在Document資料型別的變數中。 如果您選取 **相對於裝載** 選項，如果路徑欄位留空，則不會產生記錄檔案。 只有當您從「型別」下拉式清單中選取「最適化表單」時，此選項才可用。

   * **儲存Web Channel資料，使用：** 使用相對於承載的路徑儲存Web Channel資料檔案，或將其儲存在Document、JSON或表單資料模型資料型別的變數中。 只有從「型別」下拉式清單中選取「互動式通訊代理程式UI」，才能使用此選項。
   * **儲存PDF檔案，使用：** 使用相對於承載的路徑儲存PDF檔案，或將其儲存在「檔案」資料型別的變數中。 只有從「型別」下拉式清單中選取「互動式通訊代理程式UI」，才能使用此選項。
   * **儲存配置範本，使用：** 使用相對於承載的路徑儲存版面配置範本，或將其儲存在Document資料型別的變數中。 此 [版面配置範本](../../forms/using/layout-design-details.md) 是指您使用Forms Designer建立的XDP檔案。 只有從「型別」下拉式清單中選取「互動式通訊代理程式UI」，才能使用此選項。

* **受指派人>指派選項：** 指定將任務指派給使用者的方法。 您可以使用「參與者選擇器」指令碼動態地將任務指派給使用者或群組，或將任務指派給特定的AEM使用者或群組。
* **參與者選擇器：** 選項適用於 **動態至使用者或群組** 在「指派選項」欄位中選取選項。 您可以使用ECMAScript或服務來動態選取使用者或群組。 如需詳細資訊，請參閱 [動態指派工作流程給使用者](https://helpx.adobe.com/experience-manager/kb/HowToAssignAWorkflowDynamicallyToParticipants.html) 和 [建立自訂Adobe Experience Manager動態參與者步驟。](https://experienceleague.adobe.com/docs/experience-manager-learn/getting-started-wknd-tutorial-develop/overview.html?lang=en&amp;CID=RedirectAEMCommunityKautuk)

* **參與者：** 欄位出現以下情況時可用： **[!UICONTROL com.adobe.granite.workflow.core.process.RandomParticipantChooser]** 選項已選取 **參與者選擇器** 欄位。 欄位可讓您為RandomParticipantChooser選項選取使用者或群組。

* **被指定者：** 欄位出現以下情況時可用： **[!UICONTROL com.adobe.fd.workspace.step.service.VariableParticipantChooser]** 已選取以下專案中的 **參與者選擇器** 欄位。 欄位可讓您選取字串資料型別的變數，以定義受託人。

* **引數：** 在「參與者選擇器」欄位中選取RandomParticipantChoose指令碼以外的指令碼時，該欄位可用。 欄位可讓您針對「參與者選擇器」欄位中選取的指令碼，提供以逗號分隔的引數清單。

* **使用者或群組：** 任務已指派給所選的使用者或群組。 選項適用於 **至特定使用者或群組選項** 已選取以下專案中的 **指派選項** 欄位。 欄位會列出工作流程 — 使用者群組的所有使用者和群組。\
   此 **使用者或群組** 下拉式功能表會列出登入使用者有權存取的使用者和群組。 使用者名稱的顯示取決於您是否擁有 **使用者** crx-repository中該特定使用者的節點。

* **[!UICONTROL 傳送通知電子郵件]**：選取此選項以傳送電子郵件通知給受指派人。 這些通知會在任務指派給使用者或群組時傳送。 您可以使用 **[!UICONTROL 收件者電子郵件地址]** 用於指定擷取電子郵件地址的機制的選項。

* **[!UICONTROL 收件者電子郵件地址]**：您可以將電子郵件地址儲存在變數中、使用常值來指定永久電子郵件地址，或使用受指派人設定檔中指定之受指派人的預設電子郵件地址。 您可以使用常值或變數來指定群組的電子郵件地址。 變數選項有助於動態擷取和使用電子郵件地址。 此 **[!UICONTROL 使用受指派人的預設電子郵件地址]** 選項僅適用於單一受指派人。 在此情況下，會使用儲存在受指派人使用者設定檔中的電子郵件地址。

* **HTML電子郵件範本**：選取通知電子郵件的電子郵件範本。 若要編輯範本，請修改crx-repository中/libs/fd/dashboard/templates/email/htmlEmailTemplate.txt的檔案。
* **允許委派至：** AEM收件匣為登入的使用者提供將指派的工作流程委派給其他使用者的選項。 您可以委派給相同群組內的工作流程使用者，或委派給其他群組的工作流程使用者。 如果任務指派給單一使用者並且 **允許委派給受指派人群組的成員** 選項，則無法將任務委派給其他使用者或群組。
* **共用設定：** AEM收件匣提供選項，讓您與其他使用者共用收件匣中的單一或所有任務：
   * 當 **允許受分派者在收件匣中明確共用** 選項已選取，使用者可以按一下該任務並與其他AEM使用者共用該任務。
   * 當 **允許受分派者透過收件匣共用進行共用** 選項已選取，且使用者共用其「收件匣」專案或允許其他使用者存取其「收件匣」專案，只有上述選項啟用的任務才會與其他使用者共用。

* **動作>預設動作：** 「提交」、「儲存」和「重設」動作可立即使用。 預設會啟用所有預設動作。
* **路由變數：** 路由變數的名稱。 路由變數會擷取使用者在AEM收件匣中選擇的自訂動作。
* **路由：** 任務可以分支至不同的路由。 在AEM收件匣中選取時，路由會傳回值，而工作流程會根據選取的路由進行分支。 您可以將路由儲存在String資料型別陣列的變數中，或選取 **常值** 以手動新增路由。

* **標題**：指定路由的標題。 它會顯示在AEM收件匣中。
* **珊瑚圖示**：指定Coral圖示的HTML屬性。 AdobeCorelUI資料庫提供一組龐大的觸控優先圖示。 您可以選擇並使用路由圖示。 它會與標題一起顯示在AEM收件匣中。 如果您將路由儲存在變數中，路由會使用預設的「標籤」珊瑚圖示。
* **允許受分派者新增註解**：選取此選項可啟用任務的註解。 受分派者可在任務提交時從AEM收件匣新增註解。
* **將註解儲存在變數中：** 將註解儲存在String資料型別的變數中。 只有在選取 **允許受分派者新增註解** 核取方塊。

* **允許受分派者將附件新增至工作**：選取此選項可啟用工作的附件。 受指派人可在任務提交時從AEM收件匣新增附件。
* **儲存輸出工作附件，使用**：指定附件資料夾的位置。 您可以使用相對於承載的路徑或在檔案資料型別陣列的變數中儲存輸出工作附件。 只有在選取 **允許受分派者將附件新增至工作** 核取方塊並選取 **最適化表單**， **唯讀的最適化表單**，或 **非互動式PDF檔案** 從 **型別** 中的下拉式清單 **表單/檔案** 標籤。

>[!NOTE]
>
>在執行階段使用代理程式UI中的附件索引標籤，將附件與互動式通訊建立關聯。 以「完成」狀態開啟工作專案後，關聯的附件會在Sidekick中顯示為工作附件。

* **使用自訂中繼資料：** 選取此選項以啟用自訂中繼資料欄位。 自訂中繼資料用於電子郵件範本。
* **自訂中繼資料：** 選取電子郵件範本的自訂中繼資料。 自訂中繼資料可在crx-repository的apps/fd/dashboard/scripts/metadataScripts取得。 crx-repository中不存在指定的路徑。 管理員會在使用之前建立路徑。 您也可以使用自訂中繼資料的服務。 您也可以擴充WorkitemUserMetadataService介面以提供自訂中繼資料。
* **顯示先前步驟的資料**：選取此選項可讓受指派人檢視先前的受指派人、已對任務採取的動作、新增至任務的註釋，以及已完成任務的記錄檔案（若有）。
* **顯示後續步驟的資料：** 選取此選項可讓目前的受指派人檢視後續受指派人採取的動作及新增至工作的註解。 也可讓目前受指派人檢視已完成工作的記錄檔案（若有）。
* **資料型別的可見度：** 依預設，受指派人可以檢視記錄檔案、受指派人、採取的動作，以及先前和後續受指派人已新增的註解。 使用資料型別可見性選項來限制受託人可見的資料型別。

>[!NOTE]
>
>當您設定「 」時，將「指派任務」步驟儲存為草稿以及擷取「指派任務」步驟的歷史記錄的選項會停用 [!DNL Adobe Experience Manager] 外部資料儲存的工作流程模型。 此外，收件匣中已停用儲存的選項。

## 傳送電子郵件步驟 {#send-email-step}

使用電子郵件步驟來傳送電子郵件，例如含有記錄檔案、最適化表單連結、互動式通訊連結或附加PDF檔案的電子郵件。 傳送電子郵件步驟支援 [HTML電子郵件](https://en.wikipedia.org/wiki/HTML_email). HTML電子郵件會迅速回應，並因應收件者的電子郵件使用者端和熒幕大小。 您可以使用HTML電子郵件範本來定義電子郵件的外觀、色彩配置和行為。

電子郵件步驟使用Day CQ Mail Service來傳送電子郵件。 在使用電子郵件步驟之前，請確定 [電子郵件服務](../../forms/using/aem-forms-workflow.md) 已設定。 電子郵件步驟具有以下屬性：

**標題：** 步驟標題可協助識別工作流程編輯器中的步驟。

**說明：** 當您在共用開發環境中工作時，說明對於其他程式開發人員很有用。

**電子郵件主旨：** 您可以從工作流程中繼資料中擷取主旨、手動指定，或從儲存在變數中的值中擷取主旨。 從下列選項中選取：

* **常值 —** 手動指定主旨。
* **從工作流程中繼資料擷取**  — 從中繼資料屬性擷取主旨。
* **變數**  — 從字串資料型別變數中儲存的值擷取主旨。

**HTML電子郵件範本**：電子郵件的HTML範本。 您可以在電子郵件範本中指定變數。 「電子郵件步驟」會擷取並顯示範本中包含的所有變數，以供您輸入。

**電子郵件範本中繼資料：** 電子郵件範本變數的值可以是使用者指定的值、作者或發佈伺服器上的資產路徑、影像，或工作流程中繼資料屬性。

* **常值：** 知道要指定的確切值時使用選項。 例如， [example@example.com](mailto:example@example.com).

* **工作流程中繼資料：** 當要使用的值儲存至工作流程中繼資料屬性時，請使用選項。 選取選項後，在「工作流程中繼資料」選項下方的空白文字方塊中輸入中繼資料屬性名稱。 例如，emailAddress。
* **資產URL：** 使用選項將互動式通訊的網頁連結內嵌至電子郵件。 選取選項後，瀏覽並選擇要內嵌的互動式通訊。 資產可位於作者或發佈伺服器上。
* **影像：** 使用選項將影像內嵌至電子郵件。 選取選項後，瀏覽並選擇影像。 影像選項僅適用於電子郵件範本中可用的影像標籤(&lt;img src=&quot;&lt;span id=&quot; translate=&quot;no&quot; />「/>」)。&#42;

**寄件者/收件者的電子郵件地址：** 選取 **常值** 手動指定電子郵件地址或選取 **從工作流程中繼資料擷取** 從中繼資料屬性擷取電子郵件地址的選項。 您也可以為以下專案指定中繼資料屬性陣列清單： **從工作流程中繼資料擷取** 選項。 選取 **變數** 用於從儲存在字串資料型別變數中的值擷取電子郵件地址的選項。

**檔案附件：** 在指定位置可用的資產會附加至電子郵件。 資產的路徑可以是相對於承載或絕對路徑。 範例路徑為 [Payload_Directory]/attachments/.

選取 **變數** 用於擷取儲存在Document、XML或JSON資料型別變數中的檔案附件的選項。

**檔案名稱：** 電子郵件附件檔案的名稱。 「電子郵件步驟」會將附件的原始檔案名稱變更為指定的檔案名稱。 可手動指定名稱，或從工作流程中繼資料屬性或變數中擷取名稱。 使用 **常值** 選項。 使用 **變數** 從儲存在字串資料型別變數中的值擷取檔案名稱的選項。 使用 **從工作流程中繼資料擷取** 選項（當要使用的值儲存在工作流程中繼資料屬性中時）。

## 產生記錄檔案步驟 {#generate-document-of-record-step}

填寫或提交表單時，您可以以列印或檔案格式保留表單記錄。 這稱為記錄檔案(DoR)。 您可以使用「產生記錄檔案」步驟來建立最適化表單的唯讀或互動式PDF版本。 PDF版本包含填入表單的資訊以及最適化表單的版面。

「記錄檔案」步驟具有以下屬性：

**使用最適化表單**：指定尋找輸入的最適化表單的方法。 您可以使用提交至工作流程的最適化表單、在絕對路徑提供的表單，或在變數中的路徑提供的表單。 您可以使用String資料型別的變數，在 **選取要解析的變數** 欄位。\
您可以將多個最適化表單與工作流程建立關聯。 因此，您可以使用可用的輸入方法，在執行階段指定最適化表單。

**最適化表單路徑**：指定自適應表單的路徑。 當您選取 **在絕對路徑上可用** 選項來自 **使用最適化表單** 欄位。

**選擇輸入資料，使用：** 最適化表單的輸入資料路徑。 您可以將資料保留在相對於承載的位置、指定資料的絕對路徑，或擷取儲存在Document、JSON或XML資料型別變數中的資料。 輸入資料會與最適化表單合併，以建立記錄檔案。

**選擇輸入附件路徑，使用：** 附件的路徑。 這些附件包含在記錄檔案中。 您可以將附件保持在相對於承載的位置、指定附件的絕對路徑，或擷取儲存在「檔案」資料型別陣列中的附件。

如果您指定資料夾的路徑（例如附件），則資料夾中直接可用的所有檔案都會附加至記錄檔案。 如果在指定附件路徑中直接可用的資料夾中有任何檔案可用，則這些檔案會作為附件包含在記錄檔案中。 如果直接可用的資料夾中有任何資料夾，則會略過這些資料夾。

**使用以下選項儲存產生的記錄檔案：** 指定保留記錄檔案檔案的位置。 您可以選擇覆寫裝載資料夾、將記錄檔案放在裝載目錄內的某個位置，或將記錄檔案儲存在Document資料型別的變數中。

**地區設定**：指定記錄檔案的語言。 選取 **常值** 從下拉式清單中選取地區設定或選取 **變數** 以從儲存在字串資料型別變數中的值擷取地區設定。 將地區設定的值儲存在變數中時，您必須定義地區設定代碼。 例如，指定 **en_US** 英文版和 **fr_FR** 法文版。

## 啟動表單資料模型服務步驟 {#invoke-form-data-model-service-step}

您可以使用 [AEM Forms資料整合](../../forms/using/data-integration.md) 以設定並連線至不同的資料來源。 這些資料來源可以是資料庫、Web服務、REST服務、OData服務和CRM解決方案。 AEM Forms資料整合可讓您建立包含各種服務的表單資料模型，以執行資料擷取、新增、更新已設定資料庫上的操作。 您可以使用 **啟動資料模型服務步驟** 以選取表單資料模型(FDM)並使用FDM的服務來擷取、更新或新增資料至不同的資料來源。

為了說明步驟欄位的輸入，以下資料庫表格和JSON檔案為範例：

**範例CustomerDetails表格**

<table>
 <tbody> 
  <tr> 
   <td>属性</td> 
   <td>价值<br /> </td> 
  </tr> 
  <tr> 
   <td>名字<br /> </td> 
   <td>Sarah<br /> </td> 
  </tr> 
  <tr> 
   <td>姓氏</td> 
   <td>玫瑰</td> 
  </tr> 
  <tr> 
   <td>客戶ID</td> 
   <td>1</td> 
  </tr> 
  <tr> 
   <td>电子邮件地址<br /> </td> 
   <td>srose@we.info</td> 
  </tr> 
 </tbody> 
</table>

**範例JSON檔案**

```json
  { 
    customer: { 
     firstName: "Sarah", 
     lastName:"Rose", 
     customerId: "1", 
     emailAddress:"srose@we.info" 
   }, 
    insurance: {
     customerId: "1", 
    policyType: "Premium,
    policyNumber: "Premium-521499",
    customerDetails: { 
     firstName: "Sarah",
     lastName: "Rose",
     customerId: "1",
     emailAddress: "srose@we.info" 
    }
   }
  }
```

「叫用表單資料模型服務」步驟包含下列欄位，以方便表單資料模型作業：

* **標題：** 步驟的標題。 它有助於識別工作流程編輯器中的步驟。
* **說明：** 當您在共用開發環境中工作時，此說明對於其他程式開發人員很有用。

* **表單資料模型路徑**：瀏覽並選取伺服器上顯示的表單資料模型。

* **服務**：所選表單資料模型提供的服務清單。
* **服務輸入>使用常值、變數或工作流程中繼資料，以及JSON檔案提供輸入資料**：服務可以有多個引數。 選取選項，從工作流程中繼資料屬性、JSON物件、變數取得服務引數的值，或直接在提供的文字方塊中輸入值：

   * **常值：** 知道要指定的確切值時使用選項。 例如，srose@we.info。
   * **變數：** 使用選項可擷取儲存在變數中的值。
   * **從工作流程中繼資料擷取：** 當要使用的值儲存至工作流程中繼資料屬性時，請使用選項。 例如，emailAddress。
   * **[!UICONTROL 相對於裝載]**：使用選項來擷取儲存在相對於承載路徑中的檔案附件。 選取選項並指定包含檔案附件的資料夾名稱，或在文字方塊中指定檔案附件名稱。

      例如，如果CRX存放庫中的「相對於裝載」資料夾在 `attachment\attachment-folder` 位置，指定 `attachment\attachment-folder` 在文字方塊中選取 **[!UICONTROL 相對於裝載]** 選項。
   * **JSON點標籤法：** 當要使用的值位於JSON檔案中時，請使用選項。 例如，insurance.customerDetails.emailAddress。 「JSON點標籤法」選項僅在選取「從輸入JSON對應輸入欄位」選項時可用。
   * **從輸入JSON對應輸入欄位：** 指定JSON檔案的路徑，以從JSON檔案取得某些服務引數的輸入值。 JSON檔案的路徑可以是相對於裝載、絕對路徑，或者您可以使用JSON或表單資料模型型別的變數來選取輸入JSON檔案。

* **服務輸入>使用變數或JSON檔案提供輸入資料：** 選取選項，從儲存在絕對路徑、有效負載相對路徑或變數中的JSON檔案取得所有引數的值。
* **選擇輸入JSON檔案，使用**：包含所有服務引數值的JSON檔案。 JSON檔案的路徑可以是 **相對於裝載** 或 **絕對路徑。** 您也可以使用JSON或表單資料模型資料型別的變數來擷取輸入JSON檔案。

* **JSON點標籤法：** 將欄位留空將使用指定JSON檔案的所有物件作為服務引數的輸入。 若要從指定的JSON檔案讀取特定JSON物件作為服務引數的輸入，請為JSON物件指定點標籤法。例如，如果您有和區段開頭所列出的JSON類似的JSON，請指定insurance.customerDetails以提供客戶的所有詳細資訊作為服務的輸入。
* **服務>的輸出對映輸出值並寫入變數或中繼資料：** 選取選項以將輸出值儲存為crx-repository中工作流程執行個體中繼資料節點的屬性。 指定中繼資料屬性的名稱，並選取對應服務輸出屬性以對應中繼資料屬性，例如，將輸出服務傳回的phone_number對應至工作流程中繼資料的phone_number屬性。 同樣地，您可以將輸出儲存在Long資料型別的變數中。當您為 **[!UICONTROL 要對應的服務輸出屬性]** 選項，只會填入能夠儲存所選屬性資料的變數 **[!UICONTROL 將輸出儲存至]** 選項。

* **服務輸出>將輸出儲存至變數或JSON檔案：** 選取選項以將輸出值儲存在JSON檔案中的絕對路徑、相對於承載的路徑或變數中。
* **使用以下選項儲存輸出JSON檔案：** 儲存輸出JSON檔案。 輸出JSON檔案的路徑可以是相對於承載或絕對路徑。 您也可以使用JSON或表單資料模型資料型別的變數儲存輸出JSON檔案。

## 簽署檔案步驟 {#sign-document-step}

「簽署檔案」步驟可讓您使用Adobe Sign來簽署檔案。 「簽署檔案」步驟具有以下屬性：

* **合約名稱：** 指定合約的標題。 合約名稱會成為傳送給簽署者之電子郵件的主旨與內文的一部分。 您可以將名稱儲存在String資料型別的變數中，或選取 **常值** 以手動新增名稱。

* **地區設定：** 指定電子郵件和驗證選項的語言。 您可以將地區設定儲存在String資料型別的變數中，或選取 **常值** 從可用選項清單中選擇地區設定。 將地區設定的值儲存在變數中時，您必須定義地區設定代碼。 例如，指定 **en_US** 英文版和 **fr_FR** 法文版。

* **Adobe Sign雲端設定**：選擇Adobe Sign雲端設定。 如果您尚未設定適用於AEM Forms的Adobe Sign，請參閱 [將Adobe Sign與AEM Forms整合](../../forms/using/adobe-sign-integration-adaptive-forms.md).

* **使用以下專案選取要簽署的檔案：** 您可以從相對於承載的位置選擇檔案、使用承載作為檔案、指定檔案的絕對路徑，或擷取儲存在「檔案」資料型別變數中的檔案。


* **選擇輸入附件路徑，使用：** 附件的路徑。 這些附件包含在「簽署檔案」中。 您可以將附件保持在相對於承載的位置、指定附件的絕對路徑，或擷取儲存在「檔案」資料型別陣列中的附件。


   如果您指定資料夾的路徑（例如，附件），則資料夾中直接可用的所有檔案都會附加到「簽署檔案」。 如果在指定附件路徑中直接可用的資料夾中有任何檔案可用，則這些檔案會以附件的形式包含在「簽署檔案」中。 如果直接可用的資料夾中有任何資料夾，則會略過這些資料夾。

* **距離截止日期天數：** 在指定的天數內，工作沒有活動，檔案就會標示為到期（已超過期限）。 **距離截止日期天數** 欄位。 將檔案指派給使用者簽署後，會計入天數。
* **提醒電子郵件頻率：** 您可以按每日或每週間隔傳送提醒電子郵件。 從將紀錄指派給使用者以供簽署的當天開始計算該周。
* **簽章程式：** 您可以選擇以循序或平行順序簽署檔案。 依序由一位簽署者一次收到檔案以供簽署。 第一個簽署者完成檔案的簽署後，檔案會傳送給第二個簽署者，依此類推。 多個簽署者可同時以並行順序簽署一份檔案。
* **重新導向URL：** 指定重新導向URL。 檔案簽署後，您可以將受指派人重新導向至URL。 此URL通常包含感謝訊息或進一步說明。
* **工作流程階段：** 一個工作流程可以有多個階段。 這些階段會顯示在AEM收件匣中。 您可以在模型屬性中定義這些階段（Sidekick >頁面>頁面屬性>階段）。
* **選取簽署者：** 指定選擇檔案簽署者的方法。 您可以動態地將工作流程指派給使用者或群組，或手動新增簽署者的詳細資訊。
* **選取簽署者的指令碼或服務：** 只有在「選取簽署者」欄位中選取了「動態」選項時，才能使用此選項。 您可以指定ECMAScript或服務，以選擇檔案的簽署者和驗證選項。
* **簽署者詳細資訊：** 只有在「選取簽署者」欄位中選取了「手動」選項時，才能使用此選項。 指定電子郵件地址並選擇選用的驗證機制。 在選取兩步驟驗證機制之前，請確定已針對設定的Adobe Sign帳戶啟用對應的驗證選項。 您可以使用String資料型別的變數來定義 **[!UICONTROL 電子郵件]**， **[!UICONTROL 國家/地區代碼]**、和 **[!UICONTROL 電話號碼]** 欄位。 此 **[!UICONTROL 國家/地區代碼]** 和 **[!UICONTROL 電話號碼]** 欄位僅在選取時顯示 **[!UICONTROL 電話驗證]** 從 **[!UICONTROL 兩步驟驗證]** 下拉式清單。
* **狀態變數：** 啟用Adobe Sign的檔案會將檔案的簽署狀態儲存為字串資料型別的變數。 指定狀態變數的名稱(adobeSignStatus)。 CRXDE中的/etc/workflow/instances/提供了執行個體的狀態變數&lt;server>/&lt;date-time>/&lt;instance of=&quot;&quot; workflow=&quot;&quot; model=&quot;&quot;>/workItems/&lt;node>/metaData包含變數的狀態。
* **使用以下選項儲存已簽署的檔案：** 指定保留已簽署檔案的位置。 您可以選擇覆寫承載檔案、將簽署檔案放在承載目錄內的某個位置，或將簽署檔案儲存在「檔案」型別的變數中。

## 檔案服務步驟 {#document-services-steps}

AEM Document services是一組用於建立、組合和保護PDF檔案的服務。 AEM Forms為每個檔案服務提供個別的AEM Workflow步驟。

與其他AEM Forms工作流程步驟（例如指派任務、傳送電子郵件和簽署檔案）類似，您可以在所有AEM檔案服務步驟中使用變數。 如需建立和管理變數的詳細資訊，請參閱 [AEM工作流程中的變數](../../forms/using/variable-in-aem-workflows.md).

### 套用檔案時間戳記步驟 {#apply-document-time-stamp-step}

新增時間戳記至檔案。 您可以提供檔案詳細資訊，例如，輸入檔案路徑、輸入檔名稱、儲存匯出資料的位置。 您可以選擇覆寫現有的裝載檔案、選擇不同的檔案名稱，以將資料儲存在裝載資料夾下的不同檔案中、提供資料的絕對路徑，或以Document資料型別的變數儲存資料。

### 轉換為影像步驟 {#convert-to-image-step}

將PDF檔案轉換為影像清單。 支援的影像格式有JPEG、JPEG2000、PNG和TIFF。 下列資訊適用於TIFF影像的轉換：

* 會產生多頁TIFF檔案。
* 部分註解未包含在TIFF影像中。 需要Acrobat產生其外觀的註解不包括在內。

### 轉換為PDF/A步驟 {#convert-to-pdf-a-step}

使用提供的選項將PDF檔案轉換為PDF/A格式。 Portable Document Format (PDF)的PDF/A版本專門用於封存和長期儲存檔案。

### 轉換為PS步驟 {#convert-to-ps-step}

將PDF檔案轉換為PostScript。 轉換為PostScript時，您可以使用轉換作業來指定來原始檔，以及是否轉換為PostScript第2級或第3級。 您轉換成PostScript檔案的PDF檔案必須是非互動式的。

### 從指定的型別步驟建立PDF {#create-pdf-from-specified-type-step}

從輸入檔案產生PDF檔案。 輸入檔案可以是相對於裝載、具有絕對路徑、可以是裝載本身，或儲存在Document資料型別的變數中。

### 從URL/HTML/ZIP步驟建立PDF {#create-pdf-from-url-html-zip-step}

從提供的URL、HTML和ZIP檔案產生PDF檔案。

### 匯出資料步驟 {#export-data-step}

從PDF forms或XDP檔案匯出資料。 它需要您輸入「輸入檔案」和「匯出資料格式」的檔案路徑。 「匯出資料格式」的選項為Auto、XDP和XmlData。

### 指定型別步驟的Export PDF {#export-pdf-to-specified-type-step}

將PDF檔案轉換為選取的格式。

### 產生非互動式PDF步驟 {#generatenoninteractive}

產生非互動式PDF。 它提供各種自訂選項。

>[!NOTE]
>
>您可以使用變數來指定輸入檔案的範本檔案。 將範本檔案的路徑儲存在字串資料型別的變數中。

### 匯入資料步驟 {#import-data-step}

將表單資料合併至PDF表單。 您可以將表單資料匯入PDF表單。

### 叫用DDX步驟 {#invokeddx}

在指定的輸入檔案對應上執行DDX檔案，並傳回操作的PDF檔案。

>[!NOTE]
>
>您可以使用變數來指定輸入檔案的DDX檔案。 將DDX檔案儲存在Document或XML資料型別的變數中。

### Optimize PDF步驟 {#optimize-pdf-step}

透過縮小PDF檔案的大小來最佳化檔案。 此轉換的結果是PDF檔案可能小於其原始版本。 此操作也會將PDF檔案轉換為最佳化引數中所指定的PDF版本。

最佳化設定可指定檔案最佳化的方式。 以下是設定範例：

* 目標PDF版本
* 捨棄JavaScript動作和內嵌頁面縮圖等物件
* 捨棄評論和檔案附件等使用者資料
* 捨棄無效或未使用的設定
* 壓縮未壓縮資料或使用更有效率的壓縮演演算法
* 移除內嵌字型
* 設定透明度值

### 呈現PDF表單步驟 {#renderpdf}

將在Form Designer (XDP)中建立的表單轉譯為PDF表單。

>[!NOTE]
>
>您可以使用變數來指定輸入檔案的範本檔案。 將範本檔案的路徑儲存在字串資料型別的變數中。

### 安全檔案步驟 {#secure-document-step}

加密、簽署及認證檔案。 AEM Forms支援密碼型和憑證基礎加密。 您也可以選擇簽署檔案的各種演演算法。 例如，SHA-256和SH-512。 您也可以使用工作流程步驟來讀取延伸PDF檔案。 工作流程步驟提供啟用條碼解碼、數位簽名、匯入和匯出PDF資料的選項以及其他選項。

### 傳送至印表機步驟 {#send-to-printer-step}

將檔案直接傳送至印表機。 它支援下列列印存取機制：

* **可直接存取的印表機**：安裝在同一部電腦上的印表機稱為直接可存取的印表機，而電腦則稱為印表機主機。 此型別的印表機可以是直接連線到電腦的本機印表機。
* **可間接存取的印表機**：可從其他電腦存取安裝在列印伺服器上的印表機。 諸如通用UNIX®列印系統(CUPS)和Line Printer Daemon (LPD)通訊協定等技術可用於連線到網路印表機。 若要存取可間接存取的印表機，請指定列印伺服器的IP或主機名稱。 使用此機制，您可以在網路執行LPD時，將檔案傳送至LPD URI。 此機制可讓您將檔案路由到任何連線到執行LPD之網路的印表機。

### 產生列印輸出步驟 {#generatePrintedOutput}

此步驟會產生PCL、PostScript、ZPL、IPL、TPCL或DPL輸出，並提供表單設計和資料檔案。 資料檔會與表單設計合併，並格式化以供列印。 此步驟產生的輸出可以直接傳送到印表機或另存為檔案。 當您想要使用表單設計或來自應用程式的資料時，建議您使用此步驟。 如果您的表單設計或表單設計位於網路、本機檔案系統或HTTP位置，請使用generatePrintedOutput操作操作。

例如，您的應用程式要求您將表單設計與資料檔案合併。 資料包含數百筆記錄。 此外，還需要將輸出傳送至支援ZPL的印表機。 表單設計和您的輸入資料位於應用程式中。 使用generatePrintedOutput作業將每筆記錄與表單設計合併，並將輸出傳送至支援ZPL的印表機。

「產生列印輸出」步驟具有下列屬性：

**輸入屬性**

* **[!UICONTROL 選擇範本檔案，使用]**：指定範本檔案的路徑。 您可以使用相對於承載的路徑、以絕對路徑儲存的路徑，或使用Document資料型別的變數來選取範本檔案。 例如， [Payload_Directory]/Workflow/data.xml. 如果crx-repository中不存在該路徑，則管理員可以在使用該路徑之前建立該路徑。 此外，您也可以接受裝載作為輸入資料檔案。

* **[!UICONTROL 選擇資料檔案，使用]**：指定輸入資料檔案的路徑。 您可以使用相對於承載的路徑、以絕對路徑儲存的路徑，或使用Document資料型別的變數來選取輸入資料檔案。 例如， [Payload_Directory]/Workflow/data.xml. 如果crx-repository中不存在該路徑，則管理員可以在使用該路徑之前建立該路徑。

* **[!UICONTROL 印表機格式]**：指定未提供XDC檔案時用來產生輸出資料流的頁面描述語言的列印格式值。 如果您提供常值，請選取下列其中一個值：

   * **[!UICONTROL 自訂PCL]**：使用選項為PCL指定自訂XDC檔案。
   * **[!UICONTROL 自訂PostScript]**：使用選項為PostScript指定自訂XDC檔案。
   * **[!UICONTROL 自訂ZPL]**：使用選項為ZPL指定自訂XDC檔案。
   * **[!UICONTROL 一般色彩PCL (5c)]**：使用一般顏色PCL (5c)。
   * **[!UICONTROL 通用PostScript第3級]**：使用通用的PostScript Level 3。
   * **[!UICONTROL ZPL 300 DPI]**：使用ZPL 300 DPI。 使用zpl300.xdc。
   * **[!UICONTROL ZPL 600 DPI]**：使用ZPL 600 DPI。 會使用zpl600.xdc檔案。
   * **[!UICONTROL 自訂IPL]**：使用選項為IPL指定自訂XDC檔案。
   * **[!UICONTROL IPL 300 DPI]**：使用IPL 300 DPI。 使用ipl300.xdc。
   * **[!UICONTROL IPL 400 DPI]**：使用IPL 400 DPI。 使用ipl400.xdc檔案。
   * **[!UICONTROL 自訂TPCL]**：使用選項為TPCL指定自訂XDC檔案。
   * **[!UICONTROL TPCL 305 DPI]**：使用TPCL 300 DPI。 使用tpcl305.xdc檔案。
   * **[!UICONTROL PCL 600 DPI]**：使用TPCL 600 DPI。 使用tpcl600.xdc檔案。
   * **[!UICONTROL 自訂DPL]**：使用選項可指定自訂XDC檔案DPL。
   * **[!UICONTROL DPL300DPI]**：使用DPL 300 DPI。 使用dpl300.xdc檔案。
   * **[!UICONTROL DPL406DPI]**：使用DPL 400 DPI。 使用dpl406.xdc。
   * **[!UICONTROL DPL600DPI]**：使用DPL 600 DPI。 使用dpl600.xdc。

**输出属性**

* **[!UICONTROL 儲存輸出檔案，使用]**：指定儲存輸出檔案的位置。 您可以將輸出檔案儲存在相對於承載的位置、變數中，或指定絕對位置來儲存輸出檔案。 如果crx-repository中不存在該路徑，則管理員可以在使用該路徑之前建立該路徑。

**進階屬性**

* **[!UICONTROL 選擇內容根目錄位置，使用]**：內容根是字串值，可指定存放庫中的URI、絕對參照或位置，以擷取表單設計使用的相對資產。 例如，如果表單設計相對參考影像(例如../myImage.gif)，則myImage.gif必須位於repository://。 預設值為repository://，指向存放庫的根層級。

   當您從應用程式中挑選資產時，內容根URI路徑必須具有正確的結構。 例如，如果從名為SampleApp的應用程式中挑選表單，並將表單放置在SampleApp/1.0/forms/Test.xdp中，則內容根URI必須指定為repository://administrator@password/Applications/SampleApp/1.0/forms/或存放庫：/Applications/SampleApp/1.0/forms/ （當authority為null）。 以這種方式指定內容根URI時，表單中所有參考資產的路徑都將針對此URI進行解析。

* **[!UICONTROL 選擇XCI檔案，使用]**：XCI檔案用於說明用於表單設計元素的字型和其他屬性。 您可以相對於承載將XCI檔案保留在絕對路徑上，或使用Document資料型別的變數。

* **[!UICONTROL 地區設定]**：指定用來產生PDF檔案的語言。 如果您提供常值，請從清單中選取語言或選取下列其中一個值：
   * **使用伺服器預設值**：（預設）使用AEM Forms伺服器上設定的地區設定。 地區設定是使用Administration Console進行設定。 (請參閱 [Designer說明](https://www.adobe.com/go/learn_aemforms_designer_65_cn).)

   * **使用自訂值**：在常值方塊中輸入地區設定代碼，或選取包含地區設定代碼的字串變數。 如需支援地區設定代碼的完整清單，請參閱https://java.sun.com/j2se/1.5.0/docs/guide/intl/locale.doc.html。

* **[!UICONTROL 份數]**：整數值，指定要為輸出產生的副本數。 默认值为 1。

* **[!UICONTROL 雙面列印]**：指定使用雙面或單面列印的「分頁」值。 支援PostScript和PCL的印表機使用此值。如果您提供常值，請選取下列其中一個值：
   * **[!UICONTROL 雙面長邊]**：使用雙面列印，並使用長邊分頁進行列印。
   * **[!UICONTROL 雙面短邊]**：使用雙面列印，並使用短邊分頁進行列印。
   * **[!UICONTROL 單面]**：使用單面列印。
